(this["webpackJsonpreport-demo"]=this["webpackJsonpreport-demo"]||[]).push([[0],{277:function(e,t,a){},424:function(e,t,a){"use strict";a.r(t);var c=a(0),s=a.n(c),r=a(24),o=a.n(r),l=(a(277),a(1));const n=s.a.createContext(),i=e=>{let{children:t}=e;const[a,s]=Object(c.useState)(0);return Object(l.jsx)(n.Provider,{value:{currencyRate:a,setCurrencyRate:s},children:t})};var d=a(98),j=a(37),b=a(267),u=a(25),O=a(463);var h=e=>{let{onSubmit:t,loading:a,submitDisabled:s}=e;const[r,o]=Object(c.useState)({from:u.DateTime.now().toISODate(),to:u.DateTime.now().toISODate()});return Object(l.jsxs)("div",{className:"d-flex flex-column flex-sm-row justify-content-center mb-3 gap-2",children:[Object(l.jsxs)("div",{className:"d-flex flex-row justify-content-center align-items-center gap-2 text-light",children:[Object(l.jsx)("label",{className:"d-none d-sm-flex",children:"Desde:"}),Object(l.jsx)("input",{type:"date",value:r.from,onChange:e=>o({...r,from:e.target.value})}),Object(l.jsx)("label",{className:"d-none d-sm-flex",children:"Hasta:"}),Object(l.jsx)("input",{type:"date",value:r.to,onChange:e=>o({...r,to:e.target.value})})]}),Object(l.jsxs)(O.a,{variant:"primary",onClick:e=>t(e,r),disabled:a||s,children:[a&&Object(l.jsxs)("div",{children:[Object(l.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),Object(l.jsx)("span",{className:"visually-hidden",children:"Loading..."})]}),!a&&Object(l.jsx)("span",{className:"mr-2",children:"Enviar"})]})]})};const x="/api/invoices";var m=a(165),p=a(56),g=a.n(p);var f=e=>{let{data:t=[],loading:a,columns:r=[],filterPlaceholder:o,onFilter:n,maxHeight:i=350,showFooter:d=!1,onRowSelect:j,multiSelect:b=!1}=e;const{getTableProps:u,getTableBodyProps:O,headerGroups:h,footerGroups:x,rows:p,prepareRow:f,state:v}=Object(m.useTable)({columns:r,data:t},m.useRowSelect),S=g()((e=>{n(e)}),500);Object(c.useEffect)((()=>{if(b){const e=p.filter((e=>e.isSelected));j(e.map((e=>e.original)))}else{var e;j&&j(null===(e=p.find((e=>e.isSelected)))||void 0===e?void 0:e.original)}}),[v,b,j]);const y=s.a.memo((e=>{let{row:t}=e;return Object(l.jsx)("tr",{...t.getRowProps({onClick:j?e=>{const a=Object.keys(v.selectedRowIds)[Object.keys(v.selectedRowIds).length-1],c=t.index;if(e.ctrlKey&&!e.shiftKey)t.toggleRowSelected();else if(e.shiftKey&&!e.ctrlKey){if(b)if(c>=a)for(let t=a;t<=c;t++)t!==a&&p[t].toggleRowSelected();else for(let t=a;t>=c;t--)t!==a&&p[t].toggleRowSelected()}else t.isSelected||(v.selectedRowIds={}),t.toggleRowSelected()}:null}),...t.getToggleRowSelectedProps({}),children:t.cells.map(((e,a)=>Object(l.jsx)("td",{title:e.value,...e.getCellProps(),style:{background:t.isSelected?"lightblue":"white",color:t.isSelected?"white":"black"},children:e.render("Cell")})))})}),[t]);return Object(l.jsxs)("div",{children:[n&&Object(l.jsx)("div",{className:"table-filter-container",children:Object(l.jsx)("input",{className:"table-filter-input",onChange:e=>S(e.target.value),placeholder:o,autoFocus:!0})}),Object(l.jsxs)("div",{className:"table-container",style:{maxHeight:i},children:[Object(l.jsxs)("table",{...u(),children:[Object(l.jsx)("thead",{children:h.map((e=>Object(l.jsx)("tr",{...e.getHeaderGroupProps(),children:e.headers.map((e=>Object(l.jsx)("th",{...e.getHeaderProps(),children:e.render("Header")})))})))}),Object(l.jsx)("tbody",{...O(),children:p.map((e=>(f(e),Object(l.jsx)(y,{row:e}))))}),d&&t.length>0&&Object(l.jsx)("tfoot",{children:x.map((e=>Object(l.jsx)("tr",{...e.getFooterGroupProps(),children:e.headers.map((e=>Object(l.jsx)("td",{...e.getFooterProps(),children:e.render("Footer")})))})))})]}),a&&Object(l.jsx)("div",{className:"position-absolute top-50 start-50 translate-middle",children:Object(l.jsx)("span",{className:"spinner-border spinner-border-md",role:"status","aria-hidden":"true"})})]})]})},v=a(466),S=a(248),y=a.n(S);var N=[{Header:"ID",accessor:"invoiceId"},{Header:"Cliente",accessor:"client"},{Header:"RIF",accessor:"rif"},{Header:"TOTAL",accessor:"total",Cell:e=>{let{value:t}=e;return"$".concat(t?t.toFixed(2):"")}},{Header:"Fecha",accessor:"createdAt",Cell:e=>{let{value:t}=e;return y()(t).format("MMM DD, YYYY")}}];var w=e=>{let{data:t,loading:a,onRowSelect:s}=e;const r=Object(c.useMemo)((()=>N),[]);return Object(l.jsxs)(v.a,{className:"noselect",children:[Object(l.jsx)(v.a.Header,{children:Object(l.jsx)("h3",{children:"Facturas"})}),Object(l.jsx)(v.a.Body,{children:Object(l.jsx)(f,{data:t,columns:r,loading:a,onRowSelect:s,multiSelect:!0})})]})},C=a(467);var L=function(e){let{show:t,onClose:a,onSubmit:c}=e;return Object(l.jsxs)(C.a,{show:t,size:"sm",onHide:a,children:[Object(l.jsx)(C.a.Header,{closeButton:!0,onHide:a,children:Object(l.jsx)(C.a.Title,{children:"Moneda"})}),Object(l.jsxs)(C.a.Body,{children:[Object(l.jsx)(O.a,{className:"w-100 mb-3",onClick:()=>c("USD"),children:"USD"}),Object(l.jsx)(O.a,{className:"w-100",onClick:()=>c("Bs"),children:"Bs"})]})]})};var T=(e,t,a,c)=>({content:[{text:"ALIMENTOS DM MARKET, C.A.",style:"header"},{text:"CALLE ILUSTRES PROCERES LOCAL NRO S/N SECTOR CENTRO ALTAGRACIA DE ORITUCO DE ORITUCO ZONA POSTAL 2320.",style:"header"},{text:"R.I.F.: J-41270446-0",style:"header"},{text:u.DateTime.local().toFormat("dd/MM/yyyy"),style:"header"},{style:"table",table:{widths:[85,"*","auto","auto"],body:[["CATEGOR\xcdA","PRODUCTO","CANTIDAD","TOTAL (".concat(c,")")],...e.map((e=>{let{group:t,product:a,quantity:c,total:s}=e;return[t,a,c,s]})),["","",{text:t,bold:!0},{text:"".concat(c," ").concat(a),bold:!0}]]}}],styles:{header:{alignment:"center"},table:{margin:[0,20,0,0]}},pageMargins:40,pageSize:"LETTER"}),I=a(133),R=a.n(I),D=a(249),P=a.n(D);R.a.vfs=P.a.pdfMake.vfs;var F=e=>{let{data:t,totalSummary:a}=e;const{currencyRate:s}=Object(c.useContext)(n),[r,o]=Object(c.useState)(!1),i=Object(c.useMemo)((()=>t?t.reduce(((e,t)=>e+t.quantity),0):0),[t]),d=Object(c.useMemo)((()=>t?t.sort(((e,t)=>e.group.toLowerCase().localeCompare(t.group.toLowerCase())||e.product.toLowerCase().localeCompare(t.product.toLowerCase()))):[]),[t]),j=Object(c.useMemo)((()=>[{Header:"Categor\xeda",accessor:"group"},{Header:"ID",accessor:"productId"},{Header:"Producto",accessor:"product"},{Header:"Cantidad",accessor:"quantity",Footer:()=>Object(l.jsx)("span",{children:i?i.toFixed(2):""})},{Header:"Total",accessor:"total",Footer:()=>Object(l.jsxs)("span",{children:["$",a?a.toFixed(2):""]})}]),[a,i]);console.log(d);return Object(l.jsxs)(v.a,{children:[Object(l.jsx)(v.a.Header,{children:Object(l.jsxs)("div",{className:"d-flex w-100 justify-content-between",children:[Object(l.jsx)("h3",{children:"Productos"}),Object(l.jsx)(O.a,{onClick:()=>o(!0),children:"Imprimir"})]})}),Object(l.jsx)(v.a.Body,{children:Object(l.jsx)(f,{data:d,columns:j,showFooter:!0})}),r&&Object(l.jsx)(L,{show:r,onClose:()=>o(!1),onSubmit:async e=>{let t=d;"Bs"===e&&(t=t.map((e=>({...e,total:Number(e.price*e.quantity*(null===s||void 0===s?void 0:s.Cambio)).toFixed(2)}))));const c=T(t,i,a,e);R.a.createPdf(c).open()}})]})};const k=Object(c.createContext)({showNoe:!1,setShowNoe:()=>{}}),E=e=>{var t;let{children:a}=e;const[s,r]=Object(c.useState)(null!==(t=JSON.parse(localStorage.getItem("showNoe")))&&void 0!==t&&t);return Object(c.useEffect)((()=>{localStorage.setItem("showNoe",s.toString())}),[s]),Object(l.jsx)(k.Provider,{value:{showNoe:s,setShowNoe:r},children:a})};var H=()=>{const[e,t]=Object(c.useState)(!1),[a,s]=Object(c.useState)([]),[r,o]=Object(c.useState)([]),{showNoe:n}=Object(c.useContext)(k),i=Object(c.useMemo)((()=>{if(!r||0===r.length)return[];const e={};return r.forEach((t=>{t.products.forEach((t=>{e[t.productId]||(e[t.productId]={...t,quantity:0}),e[t.productId].quantity+=t.quantity,e[t.productId].total=e[t.productId].quantity*e[t.productId].price,e[t.productId].total=e[t.productId].total.toFixed(2)}))})),Object.values(e)}),[r]),d=Object(c.useMemo)((()=>r&&0!==r.length?r.reduce(((e,t)=>e+(null===t||void 0===t?void 0:t.total)),0):0),[r]);return Object(l.jsxs)(j.a,{fluid:!0,children:[Object(l.jsx)(h,{onSubmit:async(e,a)=>{e.preventDefault(),t(!0);const c=await(async(e,t)=>{let{from:a,to:c}=e;const s=await fetch("".concat(x,"?from=").concat(a,"&to=").concat(c,"&showNoe=").concat(t));return await s.json()})(a,n);s(c),t(!1)},loading:e}),Object(l.jsxs)("div",{className:"d-flex flex-column flex-xl-row justify-content-center gap-3",children:[Object(l.jsx)("div",{className:"col-12 col-xl-6",children:Object(l.jsx)(w,{data:a,loading:e,onRowSelect:o})}),Object(l.jsx)("div",{className:"col-12 col-xl-6",children:Object(l.jsx)(F,{data:i,loading:e,totalSummary:d})})]})]})};var A=[{Header:"Producto",accessor:"product"},{Header:"Cantidad",accessor:"quantity",Footer:e=>{let{data:t}=e;const a=t.reduce(((e,t)=>e+t.quantity),0);return Number(a).toFixed(2)}},{Header:"Bruto",accessor:"rawProfit",Cell:e=>{let{value:t}=e;return t?"$"+t.toLocaleString():""},Footer:e=>{let{data:t}=e;const a=t.reduce(((e,t)=>e+t.rawProfit),0);return"$"+Number(a.toFixed(2)).toLocaleString()}},{Header:"Utilidad",accessor:"netProfit",Cell:e=>{let{value:t}=e;return t?"$"+t.toLocaleString():""},Footer:e=>{let{data:t}=e;const a=t.reduce(((e,t)=>e+t.netProfit),0);return"$"+Number(a.toFixed(2)).toLocaleString()}},{Header:"Promedio",accessor:"averageProfitPercent",Cell:e=>{let{value:t}=e;return t+"%"}}];var _=e=>{let{data:t,loading:a}=e;const s=Object(c.useMemo)((()=>A),[]);return Object(l.jsx)(f,{data:t,columns:s,showFooter:!0,loading:a})};var M=e=>{let{data:t=[],onFilter:a,loading:s}=e;const[r,o]=Object(c.useState)("rawProfit"),[n,i]=Object(c.useState)([]);return Object(c.useEffect)((()=>{if(Array.isArray(t)){const e=t.sort(((e,t)=>t[r]-e[r]));i([...e])}}),[r,t]),Object(l.jsxs)("div",{className:"card",children:[Object(l.jsxs)("div",{className:"card-header",children:[Object(l.jsx)("h3",{children:"Ventas"}),Object(l.jsxs)("div",{children:[Object(l.jsx)("label",{style:{marginRight:"5px"},children:"Ordenar:"}),Object(l.jsxs)("select",{onChange:e=>o(e.target.value),value:r,children:[Object(l.jsx)("option",{value:"quantity",children:"Cantidad"}),Object(l.jsx)("option",{value:"rawProfit",children:"Bruto"}),Object(l.jsx)("option",{value:"netProfit",children:"Utilidad"}),Object(l.jsx)("option",{value:"averageProfitPercent",children:"Promedio"})]})]})]}),Object(l.jsxs)("div",{className:"card-body",children:[Object(l.jsx)("input",{className:"input-filter",placeholder:"Buscar...",type:"search",onChange:e=>a(e.target.value)}),Object(l.jsx)(_,{data:n,loading:s})]})]})},B=a(130);var U=e=>{let{chartData:t=[],loading:a}=e;return Object(l.jsxs)("div",{className:"card",children:[Object(l.jsx)("div",{className:"card-header",children:Object(l.jsx)("h3",{children:"Gr\xe1fico de categor\xedas"})}),Object(l.jsxs)("div",{className:"card-body",children:[t.length>0&&Object(l.jsx)(B.a,{data:t,margin:{top:30,right:20,bottom:20,left:20},innerRadius:.5,padAngle:.7,cornerRadius:3,activeOuterRadiusOffset:8,arcLabel:function(e){return"".concat(e.value," (").concat(e.data.netProfit,")")},borderWidth:1,arcLinkLabelsSkipAngle:10,arcLinkLabelsTextColor:"#333333",arcLinkLabelsThickness:2,arcLinkLabelsColor:{from:"color"},arcLabelsSkipAngle:10,arcLabelsTextColor:{from:"color",modifiers:[["darker",2]]},tooltip:e=>{let{datum:t}=e;return Object(l.jsxs)("div",{className:"tooltip-container",children:[Object(l.jsx)("span",{className:"small-square",style:{background:t.color}}),Object(l.jsx)("strong",{children:t.label}),Object(l.jsx)("label",{children:"Bruto: "}),Object(l.jsxs)("span",{children:["$",Number(t.value).toLocaleString()]}),Object(l.jsx)("label",{children:"Utilidad: "}),Object(l.jsxs)("span",{children:["$",Number(t.data.netProfit).toLocaleString()]})]})}}),a&&Object(l.jsx)("div",{className:"position-absolute top-50 start-50 translate-middle",children:Object(l.jsx)("span",{className:"spinner-border spinner-border-md",role:"status","aria-hidden":"true"})})]})]})};var $=()=>{const[e,t]=Object(c.useState)({filtered_invoices_report:[],invoices_report:[],group_sales_chart:[]}),[a,s]=Object(c.useState)(!1),{showNoe:r}=Object(c.useContext)(k),o=g()((a=>{const c=e.invoices_report.filter((e=>e.product.toLowerCase().includes(a.toLowerCase())));t({...e,filtered_invoices_report:c})}),500);return Object(l.jsxs)(j.a,{fluid:!0,children:[Object(l.jsx)(h,{onSubmit:async(a,c)=>{a.preventDefault(),s(!0);const o=await(async(e,t)=>{let{from:a,to:c}=e;const s=await fetch("".concat(x,"/sales?from=").concat(a,"&to=").concat(c,"&showNoe=").concat(t)),r=await s.json();return console.log("From fetchInvoiceReport: ",r),r})(c,r),l=o.group_sales_chart_data.reduce(((e,t)=>[...e,{id:t.categoria,label:t.categoria,value:t.rawProfit,netProfit:t.netProfit}]),[]);t({...e,invoices_report:o.sales_report,group_sales_chart:l}),s(!1)},loading:a}),Object(l.jsxs)("div",{className:"d-flex flex-column flex-xl-row justify-content-center gap-3",children:[Object(l.jsx)("div",{className:"col-12 col-xl-6",children:Object(l.jsx)(M,{data:e.filtered_invoices_report.length>0?e.filtered_invoices_report:e.invoices_report,onFilter:o,loading:a})}),Object(l.jsx)("div",{className:"col-12 col-xl-6",children:Object(l.jsx)(U,{chartData:e.group_sales_chart,loading:a})})]})]})};var q=[{Header:"Cliente",accessor:"client"},{Header:"Total",accessor:"total_USD",Cell:e=>{let{value:t}=e;return"$"+t.toLocaleString()}}];var z=e=>{let{data:t,loading:a}=e;const s=Object(c.useMemo)((()=>q),[]);return Object(l.jsx)(f,{data:t,columns:s,loading:a})};var G=e=>{let{loading:t,data:a=[],onFilter:c}=e;return Object(l.jsxs)("div",{className:"card",children:[Object(l.jsx)("div",{className:"card-header",children:Object(l.jsx)("h3",{children:"Mejores clientes"})}),Object(l.jsx)("div",{className:"card-body",children:a.length>0&&Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("input",{className:"input-filter",placeholder:"Buscar...",type:"search",onChange:e=>c(e.target.value,"client","client_report")}),Object(l.jsx)(z,{data:a,loading:t})]})})]})},K=a(266),J=a(261),Y=a.n(J);var W=e=>{let{placeholder:t,loadOptions:a,defaultOptions:c=!0,cacheOptions:s=!0,onSelect:r}=e;return Object(l.jsx)(K.a,{loadOptions:Y()(((e,t)=>a(e,t)),700),cacheOptions:s,defaultOptions:c,placeholder:t,onChange:r||null,loadingMessage:()=>"Cargando...",isClearable:!0})};const Z="/api/products",V=async()=>{const e=await fetch("".concat(Z,"/cost/group"));return await e.json()};var Q=e=>{let{onSelect:t}=e;return Object(l.jsx)(W,{loadOptions:async e=>{let t=await(async e=>{let{filter:t}=e;const a=t?"?filter=".concat(t):"",c=await fetch(Z+a);return await c.json()})({filter:e});if(t&&t.length>0){return t.map((e=>{let t=e.Descripcion;return{key:e.id,label:t,value:e}}))}},defaultOptions:!1,placeholder:"Buscar producto...",onSelect:(e,a)=>{let{action:c}=a;"select-option"===c?t(e.value,c):"clear"===c&&t(null,c)}})};var X=[{Header:"Cliente",accessor:"client"},{Header:"Cantidad",accessor:"quantity_total"},{Header:"Total",accessor:"total_USD",Cell:e=>{let{value:t}=e;return t?"$"+t.toLocaleString():""}},{Header:"Utilidad",accessor:"utilidad",Cell:e=>{let{value:t}=e;return t?"$"+t.toLocaleString():0}}];var ee=e=>{let{data:t,loading:a}=e;const s=Object(c.useMemo)((()=>X),[]);return Object(l.jsx)(f,{data:t,columns:s,loading:a})};const te="/api/clients";var ae=e=>{let{dateRange:t}=e;const[a,s]=Object(c.useState)(null),[r,o]=Object(c.useState)([]),[n,i]=Object(c.useState)(!1);return Object(c.useEffect)((()=>{a&&t.from&&t.to?(i(!0),(async(e,t,a)=>(await fetch("".concat(te,"/best/product/").concat(e,"?from=").concat(t.from,"&to=").concat(t.to,"&showNoe=").concat(a))).json())(a.IdProducto,t).then((e=>{o([...e]),i(!1)}))):a||o([])}),[a,t]),console.log(r),Object(l.jsxs)("div",{className:"card",children:[Object(l.jsxs)("div",{className:"card-header",children:[Object(l.jsx)("h3",{children:"Cliente por producto"}),Object(l.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:"5px"},children:[Object(l.jsx)("small",{children:"Desde: "}),Object(l.jsxs)("small",{children:[u.DateTime.fromISO(t.from).toLocaleString()," "]}),Object(l.jsx)("small",{children:"Hasta: "}),Object(l.jsxs)("small",{children:[u.DateTime.fromISO(t.to).toLocaleString()," "]})]})]}),Object(l.jsxs)("div",{className:"card-body",children:[Object(l.jsx)("div",{style:{display:"flex",flex:"1",justifyContent:"space-between"},children:Object(l.jsx)("div",{style:{width:"100%"},children:Object(l.jsx)(Q,{onSelect:s})})}),Object(l.jsx)(ee,{data:r,loading:n})]})]})};var ce=e=>{let{onSelect:t}=e;return Object(l.jsx)(W,{loadOptions:async e=>{let t=await(async e=>{let{filter:t}=e;const a=t?"?filter=".concat(t):"";return(await fetch("".concat(te).concat(a))).json()})({filter:e});if(t&&t.length>0){return t.map((e=>({key:e.IdCliente,label:e.name,value:e})))}},defaultOptions:!1,placeholder:"Buscar cliente...",onSelect:(e,a)=>{let{action:c}=a;"select-option"===c?t&&t(e.value,c):"clear"===c&&t&&t(null,c)}})},se=a(127);var re=()=>{const[e,t]=Object(c.useState)(null),[a,s]=Object(c.useState)([]),[r,o]=Object(c.useState)(!1);return Object(c.useEffect)((()=>{e?(o(!0),(async(e,t)=>(await fetch("".concat(te,"/average/month/").concat(e,"?showNoe=").concat(t))).json())(e.IdCliente).then((e=>{console.log(e),Object.keys(e).length>0&&s([e]),o(!1)}))):s([])}),[e]),Object(l.jsxs)("div",{className:"card",children:[Object(l.jsx)("div",{className:"card-header",children:Object(l.jsx)("h3",{children:"Promedio mensual"})}),Object(l.jsxs)("div",{className:"card-body",children:[Object(l.jsx)(ce,{onSelect:t}),a&&Object(l.jsx)(se.a,{data:a,margin:{top:20,right:30,bottom:80,left:40},xScale:{type:"point"},yScale:{type:"linear",min:"auto",max:"auto",stacked:!0,reverse:!1},axisTop:null,axisRight:null,pointSize:10,pointColor:{theme:"background"},pointBorderWidth:2,pointBorderColor:{from:"serieColor"},pointLabelYOffset:-12,useMesh:!0}),r&&Object(l.jsx)("div",{className:"position-absolute top-50 start-50 translate-middle",children:Object(l.jsx)("span",{className:"spinner-border spinner-border-md",role:"status","aria-hidden":"true"})})]})]})};var oe=()=>{const[e,t]=Object(c.useState)({filtered_best_clients:[],best_clients:[],group_sales_chart:[]}),[a,s]=Object(c.useState)({from:u.DateTime.now().toISODate(),to:u.DateTime.now().toISODate()}),[r,o]=Object(c.useState)(!1),n=g()((a=>{const c=e.best_clients.filter((e=>e.client.toLowerCase().includes(a.toLowerCase())));t({...e,filtered_best_clients:c})}),500);return Object(l.jsxs)(j.a,{fluid:!0,children:[Object(l.jsx)(h,{onSubmit:async(a,c)=>{a.preventDefault(),o(!0);const r=await(async(e,t)=>(await fetch("".concat(te,"/best/?from=").concat(e.from,"&to=").concat(e.to,"&showNoe=").concat(t))).json())(c);s(c),t({...e,best_clients:r}),o(!1)},loading:r}),Object(l.jsxs)("div",{className:"d-flex flex-column flex-xl-row justify-content-center gap-3",children:[Object(l.jsx)("div",{className:"col-12 col-xl-4",children:Object(l.jsx)(G,{data:e.filtered_best_clients.length>0?e.filtered_best_clients:e.best_clients,onFilter:n,loading:r})}),Object(l.jsx)("div",{className:"col-12 col-xl-4",children:Object(l.jsx)(ae,{dateRange:a})}),Object(l.jsx)("div",{className:"col-12 col-xl-4",children:Object(l.jsx)(re,{})})]})]})};var le=()=>{const[e,t]=Object(c.useState)(null),[a,s]=Object(c.useState)([]),[r,o]=Object(c.useState)(!1);return Object(c.useEffect)((()=>{if(e){(async()=>{o(!0);const t=await(async e=>{const t=await fetch("".concat(Z,"/cost-fluctuation/").concat(e));return await t.json()})(e.IdProducto);Object.keys(t).length>0&&s([t]),o(!1)})()}else e||s([])}),[e]),Object(l.jsxs)("div",{className:"card",children:[Object(l.jsx)("div",{className:"card-header",children:Object(l.jsx)("h3",{children:"Promedio mensual costo"})}),Object(l.jsxs)("div",{className:"card-body",children:[Object(l.jsx)(Q,{onSelect:t}),Object(l.jsx)(se.a,{data:a,margin:{top:20,right:30,bottom:80,left:40},xScale:{type:"point"},yScale:{type:"linear",min:"auto",max:"auto",stacked:!0,reverse:!1},axisTop:null,axisRight:null,axisLeft:{legend:"Precio",legendPosition:"middle",legendOffset:-30},axisBottom:{legend:"Meses",legendPosition:"middle",legendOffset:30},pointSize:10,pointColor:{theme:"background"},pointBorderWidth:2,pointBorderColor:{from:"serieColor"},pointLabelYOffset:-12,useMesh:!0})]}),r&&Object(l.jsx)("div",{className:"position-absolute top-50 start-50 translate-middle",children:Object(l.jsx)("span",{className:"spinner-border spinner-border-md",role:"status","aria-hidden":"true"})})]})};var ne=e=>{let{onSelect:t}=e;const{showNoe:a}=Object(c.useContext)(k);return Object(l.jsx)("div",{style:{width:"100%"},children:Object(l.jsx)(W,{loadOptions:async e=>{let t=await(async e=>{let{filter:t,showNoe:a}=e;const c=t?"?filter=".concat(t,"&showNoe=").concat(a):"",s=await fetch("/api/groups"+c);return await s.json()})({filter:e,showNoe:a});if(t&&t.length>0){return t.map((e=>({key:e.groupId,label:e.name,value:e})))}},placeholder:"Buscar categor\xeda...",onSelect:(e,a)=>{let{action:c}=a;"select-option"===c?t(e.value,c):"clear"===c&&t(null,c)}})})};var ie=[{Header:"Producto",accessor:"product"},{Header:"Precio",accessor:"price"},{Header:"Inventario",accessor:"stock"}];var de=e=>{let{data:t,loading:a}=e;const s=Object(c.useMemo)((()=>ie),[]);return Object(l.jsx)(f,{data:t,columns:s,loading:a})};var je=e=>{let{data:t=[],group:a="",currency:c}=e;return Object(l.jsxs)("table",{id:"price-list-table",children:[Object(l.jsx)("thead",{children:Object(l.jsxs)("tr",{children:[Object(l.jsx)("th",{children:"Categor\xeda"}),Object(l.jsx)("th",{children:"Producto"}),Object(l.jsx)("th",{children:"Precio (".concat(c,")")}),Object(l.jsx)("th",{children:"DISPONIBLE"})]})}),Object(l.jsx)("tbody",{children:t.map((e=>e.stock>0?Object(l.jsxs)("tr",{children:[Object(l.jsx)("td",{children:a}),Object(l.jsx)("td",{children:e.product}),Object(l.jsx)("td",{children:e.price}),Object(l.jsx)("td",{children:"EN STOCK"})]},e.productId):""))})]})},be=a(265),ue=a(163);a(419);var Oe=()=>{const[e,t]=Object(c.useState)(null),[a,s]=Object(c.useState)([]),{filteredData:r,setFilteredData:o,onFilterDebounced:i}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const[a,s]=Object(c.useState)(t),r=g()(((e,t,a)=>{a?l(e,t,a):o(e,t)}),500),o=(t,a)=>{const c=e.filter((e=>e[a].toLowerCase().includes(t.toLowerCase())));return s(c),c},l=(t,c,r)=>{console.log("nestedKLey",r);const o=e[r].filter((e=>e[c].toLowerCase().includes(t.toLowerCase())));s({...a,[r]:o})};return{filter:o,filteredData:a,setFilteredData:s,onFilterDebounced:r}}(a),d=Object(c.useRef)(null),[j,b]=Object(c.useState)(!1),[h,x]=Object(c.useState)(!1),{currencyRate:m}=Object(c.useContext)(n);return Object(c.useEffect)((()=>{if(e){const t=async()=>{b(!0);const t=await(async e=>(await fetch("".concat(Z,"/price-list/").concat(e))).json())(e.groupId);o([]),d.current.value="",s([...t]),b(!1)};t()}else e||s([])}),[e]),Object(l.jsxs)("div",{className:"card",children:[Object(l.jsxs)("div",{className:"card-header",children:[Object(l.jsx)("h3",{children:"Lista de precios por categor\xeda"}),Object(l.jsx)(O.a,{variant:"primary",onClick:()=>x(!0),children:Object(l.jsx)("span",{children:"Imprimir"})})]}),Object(l.jsxs)("div",{className:"card-body",children:[Object(l.jsxs)("div",{style:{display:"flex",gap:"20%"},children:[Object(l.jsx)(ne,{onSelect:t}),Object(l.jsx)("input",{ref:d,className:"input-filter",placeholder:"Buscar...",type:"search",onChange:e=>{i(e.target.value,"product")}})]}),Object(l.jsx)(de,{data:r.length>0?r:a,loading:j})]}),h&&Object(l.jsx)(L,{show:h,onClose:()=>x(!1),onSubmit:async e=>{console.log("currency",e);const t=await(async()=>{const e=await fetch("".concat(Z,"/group"));return await e.json()})();var a=document.createElement("div");const c=new ue.default("p","pt","a4"),s="LISTA-DE-PRECIOS-".concat(u.DateTime.fromISO((new Date).toISOString()).toLocaleString().replaceAll("/","-"),".pdf");c.setProperties({title:s}),c.setFontSize(16),c.text("ALIMENTOS DM MARKET, C.A.",300,25,{align:"center"}),c.setFontSize(6),c.text("CALLE ILUSTRES PROCERES LOCAL NRO S/N SECTOR CENTRO ALTAGRACIA DE ORITUCO DE ORITUCO ZONA POSTAL 2320.",300,35,{align:"center"}),c.setFontSize(8),c.text("R.I.F.: J-41270446-0",300,45,{align:"center"}),c.text("Tel\xe9fono:",300,55,{align:"center"}),c.setFontSize(9),c.text("LISTA DE PRECIOS AL ".concat(u.DateTime.fromISO((new Date).toISOString()).toLocaleString()),300,70,{align:"center"}),Object.keys(t).forEach((s=>{let r=t[s];r=r.map((t=>"Bs"===e?(console.log("yes currency is Bs"),{...t,price:Number(t.price*(null===m||void 0===m?void 0:m.Cambio)).toFixed(2)}):t)),a.innerHTML=Object(be.renderToStaticMarkup)(Object(l.jsx)(je,{data:r,group:s,currency:e})),c.autoTable({html:a.firstChild,styles:{cellPadding:2},didParseCell:e=>{"body"===e.section&&e.cell.raw&&"TH"===e.cell.raw.nodeName&&(e.cell.styles.fillColor="gray",e.cell.styles.color="white",e.cell.styles.cellWidth="wrap")},margin:{top:80}}),c.addPage()})),c.save(s)}})]})};var he=()=>{const[e,t]=Object(c.useState)([]),[a,s]=Object(c.useState)(!1);return Object(c.useEffect)((()=>{(async()=>{s(!0);const e=await V();if(e&&e.length){const a=e.reduce(((e,t)=>[...e,{id:t.group_name,label:t.product,value:t.total_cost}]),[]);console.log(e,a),t(a)}s(!1)})()}),[]),Object(l.jsxs)("div",{className:"card",children:[Object(l.jsx)("div",{className:"card-header",children:Object(l.jsx)("h3",{children:"Inversi\xf3n por categor\xeda"})}),Object(l.jsxs)("div",{className:"card-body",children:[e.length>0&&Object(l.jsx)(B.a,{data:e,margin:{top:30,right:20,bottom:20,left:20},innerRadius:.5,padAngle:.7,cornerRadius:3,valueFormat:e=>e.toLocaleString(),activeOuterRadiusOffset:8,borderWidth:1,arcLinkLabelsSkipAngle:10,arcLinkLabelsTextColor:"#333333",arcLinkLabelsThickness:2,arcLinkLabelsColor:{from:"color"},arcLabelsSkipAngle:10,arcLabelsTextColor:{from:"color",modifiers:[["darker",2]]}}),a&&Object(l.jsx)("div",{className:"position-absolute top-50 start-50 translate-middle",children:Object(l.jsx)("span",{className:"spinner-border spinner-border-md",role:"status","aria-hidden":"true"})})]})]})};var xe=()=>Object(l.jsx)(j.a,{fluid:!0,children:Object(l.jsxs)("div",{className:"d-flex flex-column flex-xl-row justify-content-center gap-3",children:[Object(l.jsx)("div",{className:"col-12 col-xl-4",children:Object(l.jsx)(le,{})}),Object(l.jsx)("div",{className:"col-12 col-xl-4",children:Object(l.jsx)(Oe,{})}),Object(l.jsx)("div",{className:"col-12 col-xl-4",children:Object(l.jsx)(he,{})})]})});var me=[{Header:"ID",accessor:"invoiceId"},{Header:"Cliente",accessor:"client"},{Header:"Rif",accessor:"rif"},{Header:"Fecha",accessor:"createdAt",Cell:e=>{let{value:t}=e;return u.DateTime.fromISO(t,{setZone:!0}).toFormat("F")}},{Header:"Total",accessor:"invoiceTotal",Cell:e=>{let{value:t}=e;return t?"$"+t:""},Footer:e=>{let{data:t}=e;const a=t.reduce(((e,t)=>e+t.invoiceTotal),0);return a?"$"+Number(a).toLocaleString():0}},{Header:"Comisi\xf3n",accessor:"commissionTotal",Cell:e=>{let{value:t}=e;return t?"$"+t:""},Footer:e=>{let{data:t}=e;const a=t.reduce(((e,t)=>e+t.commissionTotal),0);return a?"$"+Number(a).toLocaleString():0}}];var pe=e=>{let{data:t,loading:a}=e;const s=Object(c.useMemo)((()=>me),[]);return Object(l.jsx)(l.Fragment,{children:Object(l.jsxs)("div",{className:"card",children:[Object(l.jsx)("div",{className:"card-header",children:Object(l.jsx)("h2",{children:"Reporte de ventas"})}),Object(l.jsx)("div",{className:"card-body",children:Object(l.jsx)(f,{data:t,columns:s,loading:a,showFooter:!0,maxHeight:400})})]})})};const ge="/api/employees";var fe=e=>{let{onSelect:t}=e;return Object(l.jsx)(W,{loadOptions:async e=>{let t=await(async()=>{const e=await fetch("".concat(ge));return await e.json()})();if(t&&t.length>0){return t.map((e=>({key:e.id,label:e.name,value:e})))}},placeholder:"Buscar vendedor...",onSelect:(e,a)=>{let{action:c}=a;"select-option"===c?t&&t(e.value,c):"clear"===c&&t&&t(null,c)}})},ve=a(469),Se=a(465);var ye=e=>{let{employee:t,show:a,onClose:s}=e;const[r,o]=Object(c.useState)({data:[],loading:!1}),[n,i]=Object(c.useState)({}),[d,j]=Object(c.useState)({loading:!1,error:!1,message:""});Object(c.useEffect)((()=>{o({...r,loading:!0}),(async e=>{const t=await fetch("".concat(ge,"/commissionInfo/").concat(e)).catch((e=>({error:e})));return await t.json()})(t.id).then((e=>{o({data:e,loading:!1})}))}),[]);return Object(l.jsxs)(C.a,{show:a,size:"lg",onHide:s,children:[Object(l.jsx)(C.a.Header,{closeButton:!0,children:Object(l.jsx)(C.a.Title,{children:t.name})}),Object(l.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!d.loading){j({...d,loading:!0,text:""});const e=await(async(e,t)=>{const a=await fetch("".concat(ge,"/commissionInfo/").concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({commissionInfo:t})}).catch((e=>({error:e})));return await a.json()})(t.id,(()=>{const e={};return Object.keys(n).map((t=>{n[t]&&(e[t]=Number(n[t]))})),e})());e.error?j({error:!0,text:e.error.message,loading:!1}):e.success&&j({error:!1,text:"El recurso fue actualizado con \xe9xito",loading:!1})}},children:[Object(l.jsx)(C.a.Body,{children:Object(l.jsx)("div",{className:"row justify-content-center",children:r.data.error?Object(l.jsx)(ve.a,{variant:"danger",children:r.data.error.message}):r.loading?Object(l.jsx)(Se.a,{animation:"border"}):r.data.map((e=>Object(l.jsxs)("div",{className:"d-flex flex-column col-sm-4",children:[Object(l.jsx)("label",{className:"form-label",children:e.group}),Object(l.jsxs)("div",{className:"input-group mb-3",children:[Object(l.jsx)("span",{className:"input-group-text",id:"basic-addon1",children:"%"}),Object(l.jsx)("input",{type:"number",min:0,step:.01,className:"form-control",placeholder:e.commission||0,value:n[e.groupId]||"",onChange:t=>i({...n,[e.groupId]:t.target.value}),onFocus:e=>e.target.select()})]})]},e.groupId)))})}),Object(l.jsx)(C.a.Footer,{className:"px-0 pb-2",children:Object(l.jsxs)("div",{className:"container-fluid d-flex justify-content-between align-items-center gap-5",children:[Object(l.jsx)("div",{className:"col-9",children:d.text&&Object(l.jsx)(ve.a,{variant:d.error?"danger":"success",className:"mb-0 mt-0 p-1",children:d.text})}),Object(l.jsxs)("div",{className:"col-3 d-flex flex-wrap gap-2",children:[Object(l.jsx)(O.a,{type:"submit",variant:"success",disabled:0===Object.keys(n).length||d.loading,children:"Enviar"}),Object(l.jsx)(O.a,{variant:"danger",onClick:s,children:"Cerrar"})]})]})})]})]})};var Ne=e=>{let{onDateSubmit:t}=e;const[a,s]=Object(c.useState)(!1),[r,o]=Object(c.useState)(null),[n,i]=Object(c.useState)(!1),{showNoe:d}=Object(c.useContext)(k);return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsxs)("div",{className:"col-12 mb-4",children:[Object(l.jsxs)("div",{className:"row justify-content-end",children:[Object(l.jsx)("div",{className:"col-6 mb-2",children:Object(l.jsx)(fe,{onSelect:o})}),Object(l.jsx)("div",{className:"col-4",children:Object(l.jsx)(O.a,{variant:"primary",disabled:!r,onClick:()=>i(!0),children:"Asignar comisi\xf3n"})})]}),Object(l.jsx)(h,{onSubmit:(e,a)=>{e.preventDefault(),r&&(s(!0),(async(e,t,a)=>{const c=await fetch("".concat(ge,"/sales/").concat(e,"?from=").concat(t.from,"&to=").concat(t.to,"&showNoe=").concat(a)).catch((e=>({error:e})));return await c.json()})(r.id,a,d).then((e=>{s(!1),t(e)})))},loading:a,submitDisabled:!r})]}),n&&Object(l.jsx)(ye,{show:n,onClose:()=>i(!1),employee:r})]})};var we=()=>{const[e,t]=Object(c.useState)([]);return Object(l.jsx)(l.Fragment,{children:Object(l.jsx)("div",{className:"row justify-content-center",children:Object(l.jsxs)("div",{className:"col-sm-12 col-xl-8",children:[Object(l.jsx)(Ne,{onDateSubmit:e=>{t(e)}}),Object(l.jsx)(pe,{data:e})]})})})},Ce=a(21),Le=a(126);var Te=function(){const e=Object(Ce.f)(),{currencyRate:t,setCurrencyRate:a}=Object(c.useContext)(n),{showNoe:s,setShowNoe:r}=Object(c.useContext)(k);return Object(c.useEffect)((()=>{(async()=>{const e=await fetch("".concat("/api/currency_rates")),t=await e.json();return{status:e.status,data:t}})().then((e=>{200===e.status&&a(e.data.find((e=>"BsS"===e.Simbolo)))}))}),[]),Object(l.jsx)("div",{className:"App bg-dark",children:Object(l.jsxs)(j.a,{fluid:!0,id:"main",className:"m-0 p-0 vh-100",children:[Object(l.jsx)(d.a,{bg:"dark",variant:"dark",className:"border-bottom",expand:"lg",children:Object(l.jsxs)(j.a,{fluid:!0,children:[Object(l.jsx)(d.a.Brand,{children:"SISTEMA DE REPORTES"}),Object(l.jsx)(d.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(l.jsx)(d.a.Collapse,{id:"basic-navbar-nav",children:Object(l.jsxs)(j.a,{fluid:!0,className:"d-flex gap-5 justify-content-between align-items-center",children:[Object(l.jsx)(b.a,{className:"me-auto",children:["facturas","ventas","clientes","productos","vendedores"].map(((t,a)=>Object(l.jsx)(Le.b,{to:"/".concat(t),className:"text-decoration-none mx-1 text-secondary nav-link ".concat(e.pathname.includes(t)?"active":""),children:Object(l.jsx)("span",{style:{textTransform:"capitalize"},children:t})},a)))}),Object(l.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"20px"},children:[Object(l.jsx)("span",{className:"text-light",children:"Mostrar Facturas"}),Object(l.jsx)("div",{children:Object(l.jsxs)("label",{className:"switch",children:[Object(l.jsx)("input",{type:"checkbox",checked:s,onChange:e=>r(e.target.checked)}),Object(l.jsx)("span",{className:"slider round"})]})}),Object(l.jsx)("span",{className:"text-light",children:"Mostrar Notas"})]}),Object(l.jsx)("div",{className:"text-light",children:Object(l.jsxs)("span",{children:["REF: ",Object(l.jsx)("span",{className:"fw-bold text-info",children:null===t||void 0===t?void 0:t.Cambio})," ",null===t||void 0===t?void 0:t.Simbolo]})})]})})]})}),Object(l.jsx)(j.a,{fluid:!0,className:"py-3",children:Object(l.jsxs)(Ce.c,{children:[Object(l.jsx)(Ce.a,{path:"/facturas",component:H}),Object(l.jsx)(Ce.a,{path:"/ventas",component:$}),Object(l.jsx)(Ce.a,{path:"/clientes",component:oe}),Object(l.jsx)(Ce.a,{path:"/productos",component:xe}),Object(l.jsx)(Ce.a,{path:"/vendedores",component:we})]})})]})})};a(423);o.a.render(Object(l.jsx)(s.a.StrictMode,{children:Object(l.jsx)(Le.a,{children:Object(l.jsx)(i,{children:Object(l.jsx)(E,{children:Object(l.jsx)(Te,{})})})})}),document.getElementById("root"))}},[[424,1,2]]]);
//# sourceMappingURL=main.36647a5e.chunk.js.map